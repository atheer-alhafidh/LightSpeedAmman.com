
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Configure - Light Speed Amman</title>

    {% load static %}
    <link rel="stylesheet" href="{% static './css/navbar.css' %}">
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #eef1f5;
            color: #333;
        }

        nav button:hover,
        nav button.active,
        .dropdown:hover .dropbtn {
            background: #0a84ff;
        }

        .dropdown {
            position: relative;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: white;
            min-width: 160px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-radius: 8px;
            overflow: hidden;
        }

        .dropdown-content a {
            color: #333;
            padding: 12px 16px;
            display: block;
            text-decoration: none;
        }

        .dropdown-content a:hover {
            background: #f5f5f5;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .container {
            padding: 25px;
            max-width: 1200px;
            margin: auto;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        input,
        select {
            padding: 10px;
            width: 100%;
            max-width: 330px;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin-bottom: 15px;
        }

        button.action {
            background: #0a84ff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }

        .option-row {
            display: flex;
            align-items: center;
            gap: 40px;
            margin-top: 25px;
        }

        .option-row img {
            max-width: 480px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
<nav>
    <a href="{% url 'index' %}" class="nav-link">Home</a>
    <a href="{% url 'about_us' %}" class="nav-link">About Us</a>

    <div class="dropdown">
        <button class="dropbtn">Configure</button>
        <div class="dropdown-content">
            <a href="{% url 'configure' 'LS6' %}">LS6</a>
            <a href="{% url 'configure' 'LS8' %}">LS8</a>
        </div>
    </div>

    <a href="{% url 'contact' %}" class="nav-link">Contact</a>
    <a href="{% url 'book_test_drive' %}" class="nav-link">Book a Test Drive</a>
    {% if user.is_authenticated %}
        <form method="post" action="{% url 'logout' %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="nav-link logout-btn">
                Logout
            </button>
        </form>
    {% else %}
        <a href="{% url 'login' %}" class="nav-link">Login</a>
        <a href="{% url 'register' %}" class="nav-link">Register</a>
    {% endif %}
</nav>

<div class="container">
    <div class="card">

        {% if car_model %}

            <h2>Configure {{ car_model }}</h2>

            {% if success %}
                <p style="color: green;">Your configuration has been saved!</p>
            {% endif %}

            <form method="post" id="configForm">
                {% csrf_token %}

                <label>Package</label>
                {{ form.package }}

                <div class="option-row">
                    <div>
                        <label>Exterior</label>
                        {{ form.exterior }}
                    </div>
                    <img id="exteriorImage">
                </div>

                <div class="option-row">
                    <div>
                        <label>Interior</label>
                        {{ form.interior }}
                    </div>
                    <img id="interiorImage">
                </div>

                <button type="submit" class="action">Save Configuration</button>
            </form>

        {% else %}

            <h2>Please select a car model</h2>
            <p>Use the <strong>Configure</strong> menu above to choose LS6 or LS8.</p>

        {% endif %}

    </div>
</div>


<script>
    const carModel = "{{ car_model }}";

    const EXTERIOR_IMAGES = {
        'LS6': {
            'Metallic Champagne': "{% static 'images/exterior/metallic-champagne-ls6.png' %}",
            'Aurora': "{% static 'images/exterior/aurora-ls6.png' %}",
            'Snow White': "{% static 'images/exterior/snow-white-ls6.png' %}",
            'Graphite Black': "{% static 'images/exterior/graphite-black-ls6.png' %}"
        },
        'LS8': {
            'Snow White': "{% static 'images/exterior/snow-white-ls8.png' %}",
            'Graphite Black': "{% static 'images/exterior/graphite-black-ls8.png' %}"
        }
    };

    const INTERIOR_IMAGES = {
        'LS6': {
            'Crimson': "{% static 'images/interior/crimson.jpg' %}",
            'Elegant Black': "{% static 'images/interior/elegant-black.jpg' %}",
            'Off-White': "{% static 'images/interior/off-white.jpg' %}"
        },
        'LS8': {
            'Crimson': "{% static 'images/interior/crimson.jpg' %}",
            'Elegant Black': "{% static 'images/interior/elegant-black.jpg' %}",
            'Off-White': "{% static 'images/interior/off-white.jpg' %}"
        }
    };

    const exteriorSelect = document.getElementById("id_exterior");
    const interiorSelect = document.getElementById("id_interior");
    const exteriorImage = document.getElementById("exteriorImage");
    const interiorImage = document.getElementById("interiorImage");

    function updateImages() {
        exteriorImage.src = EXTERIOR_IMAGES[carModel][exteriorSelect.value];
        interiorImage.src = INTERIOR_IMAGES[carModel][interiorSelect.value];
    }

    window.addEventListener('DOMContentLoaded', () => {
        exteriorSelect.selectedIndex = 0;
        interiorSelect.selectedIndex = 0;
        updateImages();
    });

    exteriorSelect.addEventListener('change', updateImages);
    interiorSelect.addEventListener('change', updateImages);
</script>

<script>
    const form = document.getElementById("configForm");

    form.addEventListener("submit", function (e) {
        e.preventDefault();

        fetch("", {
            method: "POST",
            headers: {
                "X-CSRFToken": "{{ csrf_token }}",
            },
            body: new FormData(form)
        })
        .then(response => {
            if (response.status === 401) {
                alert("Please login first to save your configuration.");
                window.location.href = "{% url 'login' %}?next={{ request.path }}";
                return;
            }
            return response.json();
        })
        .then(data => {
            if (data && data.success) {
                alert("Configuration saved successfully!");
                location.reload();
            }
        });
    });
</script>


</body>
</html>
